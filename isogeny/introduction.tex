Let $E$ and $E'$ be two elliptic curves defined over $\K$, by finding
an \emph{explicit isogeny} we mean to find an ($\F_q$-rational)
rational function from $E(\clot{\K})$ to $E'(\clot{\K})$ such that the
map it defines is an isogeny. 

In this chapter we are interested in finding explicit isogeny of
ordinary elliptic curves over finite fields. In what follows $\F_q$
will be a finite field of characteristic $p$, and $d$ the positive
integer such that $q=p^d$.

Part of this chapter and of the following have been published
in~\cite{df10}.


\section{Overview}
\label{sec:history}

The problem of computing an explicit degree $\ell$ isogeny between two
given elliptic curves over $\F_q$ was originally motivated by point
counting methods based on Schoof's algorithm
\cite{atkin88,elkies92,elkies98,schoof95}. A review of the most
efficient algorithms to solve this problem is given in
\cite{bostan+morain+salvy+schost08}, together with a new quasi-optimal
algorithm that we will review in Section~\ref{sec:bmss}.

All the algorithms of \cite{bostan+morain+salvy+schost08} only work
when $\ell\ll p$. The case where $p$ is small compared to $\ell$ was
first treated by Couveignes in \cite{couveignes94}, making use of
formal groups. The complexity of his method is $\tildO(\ell^3\log q)$ operations in
$\F_p$ assuming $p$ is constant, however it has an exponential
complexity in $\log p$.

Later, Lercier \cite{lercier96} gave an algorithm specific the
characteristic $2$, that uses some linear properties of the problem to
build a linear system from whose solution the isogeny can be
deduced. Its complexity is conjectured to be $\tildO(\ell^3\log q)$
operations in $\F_p$, but it has a much better constant factor than
\cite{couveignes94}. At the moment we write, this is by many orders of
magnitude the fastest algorithm to solve practical instances of the
problem when $p=2$, thus being the \emph{de facto} standard for
cryptographic use.

Couveignes, again, proposed an algorithm in \cite{couveignes96}
working for any $p$, based on the structure of the $p^k$ torsion of
ordinary elliptic curves. Using improvements
from~\cite{couveignes00,df+schost09,df10}, this algorithm has a
quadratic complexity in $\ell$, thus being the best algorithm, with
respect to this parameter, working for any $p$. We review the original
algorithm as well as its improved variants in Sections~\ref{sec:C2}
to~\ref{sec:bounded}.

After the discovery of $p$-adic alternatives to Schoof's
algorithm\cite{satoh00}, interest in computing isogenies in small
characteristic was lost. Nevertheless, two $p$-adic algorithms were
recently proposed by Joux and Lercier \cite{joux+lercier06} and
Lercier and Sirvent \cite{lercier+sirvent08} to solve the isogeny
problem. The former method has complexity $\tildO(\ell^2(1 +
\ell/p)\log q)$ operations in $\F_p$, which makes it well adapted to
the case where $p\sim\log q$. The latter has complexity $\tildO(\ell^3
+ \ell\log q^2)$ operations in $\F_p$, making it the best algorithm to
our knowledge for the case where $p$ is not constant. We review the
second algorithm in Section~\ref{sec:lercier-sirvent}.


\section{Vélu formulas}
\label{sec:velu-formulas}


\begin{figure}
  \centering
  \[\xymatrix{
    E \ar[r]^{[m]}\ar@/_1pc/[rrr]_{\I'} & E \ar[r]^\I & E' \ar[r]^{\frobisog^n} & E'^{(p^n)}\\
  }\]
  \label{fig:fact}
  \caption{Factorization of an isogeny. $\I'$ has kernel $E[m]\oplus\ker\I$.}
\end{figure}

Since an isogeny can be uniquely factored in the product of a
separable and a purely inseparable isogeny, we focus on the problem of
computing explicit separable isogenies. Furthermore one can factor out
multiplication-by-$m$ maps, thus reducing the problem to compute
explicit separable isogenies with cyclic kernel (see figure
\ref{fig:fact}).

In the rest of this chapter, unless otherwise stated, by
$\ell$-isogeny we mean a separable isogeny with kernel isomorphic to
$\Z/\ell\Z$.


For any finite subgroup $G \subset E(\clot{\K})$, Vélu formulas
\cite{Vel71} give in a canonical way an elliptic curve $\bar{E}$ and
an explicit separable isogeny $\I:E\rightarrow \bar{E}$ such that
$\ker\I=G$. The isogeny is $\K$-rational if and only if the polynomial
vanishing on the abscissae of $G$ belongs to $\K[X]$.

The isogeny computed by Vélu formulas is the map
\begin{multline}
  \label{eq:155}
  P\mapsto\left(x(P) + \sum_{Q\in G\backslash\{\0\}}x(P+Q) - x(Q),\right.\\
    \left.y(P) + \sum_{Q\in G\backslash\{\0\}}y(P+Q) - y(Q)\right)
  \text{.}
\end{multline}
Using the addition formulas it is straightforward to obtain the
coefficients of the curve $\bar{E}$ and the explicit isogeny.

For simplicity, we suppose $p\ge3$ and $E$ in
\hyperref[th:simplified-weierstrass]{simplified Weierstrass form}
\begin{equation}
  \label{eq:160}
  E \;:\; y^2 =  x^3 + a_2x^2 + a_4x + a_6
  \text{.}
\end{equation}
We denote by $f,f'$ the two functions in $\K(E)$
\begin{equation}
  \label{eq:162}
  \begin{aligned}
    f(P) &= x(P)^3 + a_2x(P)^2 + a_4x(P) + a_6
    \text{,}\\
    f'(P) &= 3x(P)^2 + 2a_2x(P) + a_4
    \text{.}
  \end{aligned}
\end{equation}

Then, after some calculations, Eq.~\eqref{eq:155} is equivalent to
\begin{multline}
  \label{eq:161}
  (x,y) \mapsto
  \left(x + \sum_{Q\in G\backslash\{\0\}} \frac{f'(Q)}{x-x(Q)} + \frac{2f(Q)}{(x-x(Q))^2},\right.\\
  \left.y + \sum_{Q\in G\backslash\{\0\}} \frac{yf'(Q)}{(x-x(Q))} + \frac{4yf(Q)}{(x-x(Q))^3}\right)
  \text{;}
\end{multline}
and the isogenous curve has equation
\begin{equation}
  \label{eq:163}
  \bar{E}\;:\;y^2 = x^3 + a_2x^2 + (a_4-5t)x + a_6 - 4a_2t - 7w
  \text{,}
\end{equation}
where
\begin{equation}
  \label{eq:164}
  t = \sum_{Q\in G\backslash\{\0\}} f'(Q)\text{,}
  \qquad
  w = \sum_{Q\in G\backslash\{\0\}} 2f(Q) + x(Q)f'(Q)\text{.}
\end{equation}


In practice, supposing we know the polynomial
\begin{equation}
  \label{eq:158}
  h(x) = \prod_{Q\in G\backslash\{\0\}}}(x - x(Q))
\end{equation}
vanishing over the abscissae of $G$, we compute its three first Newton
sums $p1,p_2,p_3$, and the polynomials
\begin{equation}
  \label{eq:166}
  \begin{aligned}
    \Sigma_1(x) &= \sum_{Q\in G\backslash\{\0\}}\frac{1}{x-x(Q)} = \frac{h'}{h}\text{,}\\
    \Sigma_2(x) &= \sum_{Q\in G\backslash\{\0\}}\frac{1}{(x-x(Q))^2} = -\left(\frac{h'}{h}\right)'\text{.}\\
  \end{aligned}
\end{equation}
Then we compute
\begin{equation}
  \label{eq:167}
  \begin{aligned}
    t = 3p_2 + 2a_2p_1 + a_4\text{,} \qquad
    w = 5p_3 + 4a_2p_2 + 3a_4p_1 + 2a_6\text{,}
  \end{aligned}
\end{equation}





 Vélu formulas compute a rational function
\begin{equation}
  \label{eq:isog}
  \bar{\I}(x,y) = \left(\frac{g(x)}{h(x)}, \frac{k(x,y)}{l(x)}\right)  
\end{equation}
and a curve $\bar{E}$ such that $\bar{\I} : E\rightarrow\bar{E}$ is an
$\K$-rational isogeny of kernel $G$. A consequence of Vélu formulas
is
\begin{equation}
  \label{eq:velu-deg}
  \deg g = \deg h + 1 = \card{G}
  \text{.}
\end{equation}
Given two curves $E$ and $E'$, Vélu formulas reduce the problem of
finding an explicit isogeny between $E$ and $E'$ to that of finding
the kernel of an isogeny between them. Once the polynomial $h(X)$
vanishing on $\ker\I$ is found, the explicit isogeny is computed
composing Vélu formulas with the isomorphism between $\bar{E}$ and
$E'$ as in figure \ref{fig:velu}.

\begin{figure}
  \centering
  \[\xymatrix{
    E \ar[r]^{\bar{\I}} \ar[rd]^\I & \bar{E} \ar[d]^{\simeq}\\
    & E'
  }\]
  \caption{Using Vélu formulas to compute an explicit isogeny.}
  \label{fig:velu}
\end{figure}




% Local Variables:
% mode:flyspell
% ispell-local-dictionary:"american"
% mode:TeX-PDF
% mode:reftex
% TeX-master: "../these"
% End:
%
% LocalWords:  Schreier Artin pseudotrace frobenius bivariate Joux Sirvent FFT
% LocalWords:  Couveignes isogenies Schoof isogeny cryptosystems Lercier
% LocalWords:  precomputation arithmetics polylogarithmic Karatsuba
