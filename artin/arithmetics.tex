\section{Preliminaries}
\label{sec:arithmetics}

As a general rule, variables and polynomials are in upper
case; elements algebraic over $\F_p$ (or some other field, that will
be clear from the context) are in lower case.
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Element representation}\label{ssec:rep}

We let $Q_0$ be in $\F_p[X_0]$ and $\U_0=\F_p[X_0]/Q_0$.

\begin{definition}
  Let $(G_i)_{0 \le i < k}$ be a sequence of polynomials over $\F_p$,
  with $G_i$ in $\F_p[X_0,\dots,X_i]$.  The sequence $(G_i)_{0\le i
    <k}$ is said to {\em define the tower} $(\U_0,\dots,\U_k)$ if for
  $i \ge 0$, $\U_i=\F_p[X_0,\dots,X_i]/K_i$, where $K_i$ is the ideal
  generated by
  \begin{equation}
    \label{eq:57}
    \left | \begin{array}{l}
        P_i=X_i^p-X_i -G_{i-1}(X_0,\dots,X_{i-1})\\
        ~~~\,~\vdots\\
        P_1=X_1^p-X_1-G_0(X_0)\\
        Q_0(X_0)
      \end{array}\right .
  \end{equation}
  in $\F_p[X_0,\dots,X_i]$, and if $\U_i$ is a field. 
\end{definition}

Clearly $\U_i\subset\U_{i+1}$. The residue class of $X_i$
(resp. $G_i$) in $\U_i$, and thus in $\U_{i+1},\dots$, is written
$x_i$ (resp. $\gamma_i$), so that we have $x_i^p-x_i=\gamma_{i-1}$.

Finding a suitable $\F_p$-basis to represent elements of a tower
$(\U_0,\dots,\U_k)$ is a crucial question. 

\begin{definition}[Multivariate basis]
  If $d=\deg(Q_0)$, the \emph{multivariate basis} $\basis{B}_i$ of
  $\U_i$ is
  \begin{equation}
  \label{eq:58}
  \basis{B}_i=
  \{x_0^{e_0} \cdots x_i^{e_i} \;|\; 0 \le e_0 < d,\; 0\le e_j < p 
  \text{ for $j>0$}\}
  \text{.}
\end{equation}
\end{definition}

However, in this basis, we do not have very efficient arithmetic
operations, starting from multiplication. Indeed, the natural approach
to multiplication in $\bB_i$ consists in a polynomial multiplication,
followed by reduction modulo $(Q_0,P_1,\dots,P_i)$; however, the
initial product gives a polynomial of partial degrees
$(2d-2,2p-2,\dots,2p-2)$, so the number of monomials appearing is not
linear in $[\U_i:\F_p]=p^id$.  See~\cite{li+moreno+schost07} for
details.

As a workaround, we introduce the notion of a {\em primitive tower}.

\begin{definition}[Primitive tower]
  A tower $(\U_0,\ldots,\U_k)$ defined by $(G_i)_{0 \le i < k}$ is
  said to be \emph{primitive} if
  \begin{equation}
    \label{eq:59}
    \U_i = \F_p[x_i]
  \end{equation}
  for all $i$. In this case, we let $Q_i\in \F_p[X]$ be its minimal
  polynomial, of degree $p^id$.
\end{definition}

\begin{definition}[Univariate basis]
  Let $(\U_0,\ldots,\U_k)$ be a primitive tower, the \emph{univariate
    basis} $\basis{C}_i$ of $\U_i$ is the $\F_p$-basis
  \begin{equation}
    \label{eq:60}
    \basis{C}_i=(1,x_i,\dots,x_i^{p^id-1})
    \text{.}  
  \end{equation}
  To stress the fact that $v\in\U_i$ is represented on the univariate
  basis, we write $v\wrt\U_i$.
\end{definition}

In a primitive tower, unless otherwise stated, we represent the
elements of $\U_i$ on the univariate basis. In this basis, assuming
$Q_i$ is known, additions and subtractions are done in time $p^id$,
multiplications in time $O(\Mult(p^id))$~\cite[Chapter~9]{vzGG} and
inversions in time $O(\Mult(p^id)\log(p^id))$~\cite[Chapter~11]{vzGG}.

Remark that having fast arithmetic operations in $\U_i$ enable us to
write fast algorithms for polynomial arithmetic in $\U_i[Y]$, where
$Y$ is a new variable. Extending the previous notation, let us write
$A \wrt\U_i[Y]$ to indicate that a polynomial $A \in \U_i[Y]$ is
written on the basis $(x_i^\alpha Y^\beta)_{0 \le \alpha < p^id, 0 \le
  \beta}$ of $\U_i[Y]$.  Then, given $A,B \wrt \U_i[Y]$, both of
degrees less than $n$, one can compute $AB \wrt \U_i[Y]$ in time
$O(\Mult(p^id n))$ using Kronecker's
substitution~\cite[Lemma~2.2]{vzgathen+shoup92}.

One can extend the fast Euclidean division algorithm to this context,
as Newton iteration reduces Euclidean division to polynomial
multiplication. The analysis of~\cite[Chapter~9]{vzGG} implies that
Euclidean division of a degree $n$ polynomial $A \wrt \U_i[Y]$ by a
monic degree $m$ polynomial $B \wrt \U_i[Y]$, with $m \le n$, can be
done in time $O(\Mult(p^id n))$.

Finally, fast GCD techniques carry over as well, as they are based on
multiplication and division. Using the analysis
of~\cite[Chapter~11]{vzGG}, we see that the extended GCD of two monic
polynomials $A,B \wrt \U_i[Y]$ of degree at most $n$ can be computed
in time $O(\Mult(p^id n \log(n)))$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Trace and pseudotrace}\label{ssec:tpt}


We continue with a few useful facts on traces.

\begin{proposition}
  We have the following well-known properties:
  \begin{align}
  \tag{$\mathbf{P}_1$} &\begin{array}{c}  
  \Tr_{\F_{q^n}/\F_q}: a \mapsto \sum_{\ell=0}^{n -
    1}a^{q^\ell} \text{,}
  \end{array}\\
  \tag{$\mathbf{P}_2$}\label{eq:trcomp}
  &\Tr_{\F_{q^{mn}}/\F_q} = \Tr_{\F_{q^m}/\F_q} \circ
  \Tr_{\F_{q^{mn}}/\F_{q^m}}\text{.}
\end{align}
\end{proposition}
\begin{proof}
  This is a direct consequence of
  Proposition~\ref{th:basic-galois-theory:trace}.
\end{proof}

\begin{proposition}
  \label{th:p3}
  If $\U'/\U$ is an Artin-Schreier extension generated by a polynomial
  $Q$ and $x$ is a root of $Q$ in $\U'$, then
\begin{equation}
  \tag{$\mathbf{P}_3$}\label{eq:pd} \Tr_{\U'/\U}(x^j) = 0~ \text{for}~j
  <p-1; \quad \Tr_{\U'/\U}(x^{p-1}) = -1\text{.}
\end{equation}
\end{proposition}
\begin{proof}
  This is a consequence of Lemma~\ref{th:multi-newton-sums}. In fact
   \begin{equation}
    \label{eq:25}
    \sum_{i\ge0} \frac{\Tr(x^{i})}{T^{i+1}} = \frac{Q'(T)}{Q(T)} =
    -\frac{1}{T^p-T-\alpha}
    \text{,}
  \end{equation}
  from which we deduce
  \begin{align}
    \label{eq:61}
    &\Tr(x^i) = 0 &\text{for $0\le i<p-1$,}\\
    &\Tr(x^{p-1}) - \Tr(1) = \Tr(x^{p-1}) = -1\text{,}\\
    \label{eq:62}
    &\Tr(x^{i+p}) - \Tr(x^{i+1}) - \alpha\Tr(x^{i}) = 0 &\text{for $i\ge 0$.}
  \end{align}
\end{proof}

Following~\cite{couveignes00}, we also use a generalization of the
trace.

\begin{definition}[Pseudotrace]
  The $n$-th {\em pseudotrace} of order $m$ is the
  $\F_{p^m}$-linear operator
  \begin{equation*}
    \begin{array}{c}  \PTr_{(n,m)}: a \mapsto \sum_{\ell=0}^{n-1}a^{p^{m\ell}};\end{array}
  \end{equation*}
  for $m=1$, we call it the $n$-th pseudotrace and write $\PTr_n$.
\end{definition}

In our context, for $n=[\U_i:\U_j]=p^{i-j}$ and $m=[\U_j:\F_p]=p^jd$,
$\PTr_{(n,m)}(v)$ coincides with $\Tr_{\U_{i}/\U_j}(v)$ for $v$ in
$\U_i$; however $\PTr_{(n,m)}(v)$ remains defined for $v$ not in
$\U_i$, whereas $\Tr_{\U_{i}/\U_j}(v)$ is not.



% Local Variables:
% mode:flyspell
% ispell-local-dictionary:"american"
% mode: TeX-PDF
% mode: reftex
% TeX-master: "../these"
% End:
%
% LocalWords:  Schreier Artin pseudotrace frobenius bivariate memoization
