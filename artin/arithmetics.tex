\section{Preliminaries}
\label{sec:arithmetics}

As a general rule, variables and polynomials are in upper
case; elements algebraic over $\F_p$ (or some other field, that will
be clear from the context) are in lower case.
 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Element representation}\label{ssec:rep}

We let $Q_0$ be in $\F_p[X_0]$ and $\U_0=\F_p[X_0]/Q_0$.

\begin{definition}
  \label{def:primitive-tower}
  Let $(G_i)_{0 \le i < k}$ be a sequence of polynomials over $\F_p$,
  with $G_i$ in $\F_p[X_0,\dots,X_i]$.  The sequence $(G_i)_{0\le i
    <k}$ is said to {\em define the tower} $(\U_0,\dots,\U_k)$ if for
  $i \ge 0$, $\U_i=\F_p[X_0,\dots,X_i]/K_i$, where $K_i$ is the ideal
  generated by
  \begin{equation}
    \label{eq:57}
    \left | \begin{array}{l}
        P_i=X_i^p-X_i -G_{i-1}(X_0,\dots,X_{i-1})\\
        ~~~\,~\vdots\\
        P_1=X_1^p-X_1-G_0(X_0)\\
        Q_0(X_0)
      \end{array}\right .
  \end{equation}
  in $\F_p[X_0,\dots,X_i]$, and if $\U_i$ is a field. 

  The residue class of $X_i$ (resp. $G_i$) in $\U_i$, and thus in
  $\U_{i+1},\dots$, is written $x_i$ (resp. $\gamma_i$), so that we
  have $x_i^p-x_i=\gamma_{i-1}$.
\end{definition}

Finding a suitable $\F_p$-basis to represent elements of a tower
$(\U_0,\dots,\U_k)$ is a crucial question. 

\begin{definition}[Multivariate basis]
  If $d=\deg(Q_0)$, the \emph{multivariate basis} $\basis{B}_i$ of
  $\U_i$ is
  \begin{equation}
  \basis{B}_i=
  \{x_0^{e_0} \cdots x_i^{e_i} \;|\; 0 \le e_0 < d,\; 0\le e_j < p 
  \text{ for $j>0$}\}
  \text{.}
\end{equation}
\end{definition}

However, in this basis, we do not have very efficient arithmetic
operations, starting from multiplication. Indeed, the natural approach
to multiplication in $\basis{B}_i$ consists in a polynomial multiplication,
followed by reduction modulo $(Q_0,P_1,\dots,P_i)$; however, the
initial product gives a polynomial of partial degrees
$(2d-2,2p-2,\dots,2p-2)$, so the number of monomials appearing is not
linear in $[\U_i:\F_p]=p^id$.  See~\cite{li+moreno+schost07} for
details.

As a workaround, we introduce the notion of a {\em primitive tower}.

\begin{definition}[Primitive tower]
  With the same notation of Definition~\ref{def:primitive-tower}, a
  tower $(\U_0,\ldots,\U_k)$ defined by $(G_i)_{0 \le i < k}$ is said
  to be \emph{primitive} if
  \begin{equation}
    \label{eq:59}
    \U_i = \F_p[x_i]
  \end{equation}
  for all $i$. In this case, we let $Q_i\in \F_p[X]$ be the minimal
  polynomial of $x_i$, of degree $p^id$.
\end{definition}

\begin{definition}[Univariate basis]
  \pdfmargincomment[color=red,subject=rev2]{Explicit indices for the basis.}
  Let $(\U_0,\ldots,\U_k)$ be a primitive tower, the \emph{univariate
    basis} $\basis{C}_i$ of $\U_i$ is the $\F_p$-basis
  \begin{equation}
    \basis{C}_i=\{x_i^a \;|\; 0\le a<p^id\}
    \text{.}  
  \end{equation}
  To stress the fact that $v\in\U_i$ is represented on the univariate
  basis, we write $v\wrt\U_i$.
\end{definition}

In a primitive tower, unless otherwise stated, we represent the
elements of $\U_i$ on the univariate basis. In this basis, assuming
$Q_i$ is known, additions and subtractions are done in time $p^id$,
multiplications in time $O(\Mult(p^id))$ and inversions in time
$O(\Mult(p^id)\log(p^id))$ (see Section~\ref{sec:fund-algor}).

Remark that having fast arithmetic operations in $\U_i$ enables us to
write fast algorithms for polynomial arithmetic in $\U_i[Y]$, where
$Y$ is a new variable. Extending the previous notation, let us write
$A \wrt\U_i[Y]$ to indicate that a polynomial $A \in \U_i[Y]$ is
written on the basis $(x_i^\alpha Y^\beta)_{0 \le \alpha < p^id, 0 \le
  \beta}$ of $\U_i[Y]$.  Then, given $A,B \wrt \U_i[Y]$, both of
degrees less than $n$, one can compute $AB \wrt \U_i[Y]$ in time
$O(\Mult(p^id n))$ using Kronecker's substitution (see
Section~\ref{sec:mult-polyn}).

One can extend the fast Euclidean division algorithm to this context,
as Newton iteration reduces Euclidean division to polynomial
multiplication (see Section~\ref{sec:newtons-iteration}). This implies
that Euclidean division of a degree $n$ polynomial $A \wrt \U_i[Y]$ by
a monic degree $m$ polynomial $B \wrt \U_i[Y]$, with $m \le n$, can be
done in time $O(\Mult(p^id n))$.

Finally, fast GCD techniques carry over as well, as they are based on
multiplication and division. As we saw in
Section~\ref{sec:eucl-algor-rati}, the extended GCD of two monic
polynomials $A,B \wrt \U_i[Y]$ of degree at most $n$ can be computed
in time $O(\Mult(p^id n \log(n)))$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Trace and pseudotrace}\label{ssec:tpt}


We continue with a few useful facts on traces.

\begin{proposition}
  We have the following well-known properties:
  \begin{align}
  \tag{$\mathbf{P}_1$}\label{eq:78} &\begin{array}{c}  
  \Tr_{\F_{q^n}/\F_q}: a \mapsto \sum_{\ell=0}^{n -
    1}a^{q^\ell} \text{,}
  \end{array}\\
  \tag{$\mathbf{P}_2$}\label{eq:trcomp}
  &\Tr_{\F_{q^{mn}}/\F_q} = \Tr_{\F_{q^m}/\F_q} \circ
  \Tr_{\F_{q^{mn}}/\F_{q^m}}\text{.}
\end{align}
\end{proposition}
\begin{proof}
  This is a direct consequence of
  Proposition~\ref{th:basic-galois-theory:trace}.
\end{proof}

\begin{proposition}
  \label{th:p3}
  If $\U'/\U$ is an Artin-Schreier extension generated by a polynomial
  $Q$ and $x$ is a root of $Q$ in $\U'$, then
\begin{equation}
  \tag{$\mathbf{P}_3$}\label{eq:pd} \Tr_{\U'/\U}(x^j) = 0~ \text{for}~j
  <p-1; \quad \Tr_{\U'/\U}(x^{p-1}) = -1\text{.}
\end{equation}
\end{proposition}
\begin{proof}
  This is a consequence of Lemma~\ref{th:multi-newton-sums}. In fact
  \begin{equation}
    \sum_{i\ge0} \frac{\Tr(x^{i})}{T^{i+1}} = \frac{Q'(T)}{Q(T)} =
    -\frac{1}{T^p-T-\alpha}
    \text{,}
  \end{equation}
  from which we deduce
  \begin{align}
    \label{eq:61}
    &\Tr(x^i) = 0 &\text{for $0\le i<p-1$,}\\
    &\Tr(x^{p-1}) - \Tr(1) = \Tr(x^{p-1}) = -1\text{,}\\
    &\Tr(x^{i+p}) - \Tr(x^{i+1}) - \alpha\Tr(x^{i}) = 0 &\text{for $i\ge 0$.}
  \end{align}
\end{proof}

\begin{proposition}
  \label{th:artin-schreier}
  The Artin-Schreier polynomial $X^p-X-\alpha$ is irreducible in $\F_q$
  if and only if
  \begin{equation}
    \label{eq:62}
    \Tr_{\F_q/\F_p}(\alpha) \ne 0
    \text{.}
  \end{equation}
  If it is reducible, then it is split and its roots are 
  \begin{equation}
    \label{eq:63}
    \eta, \eta+1, \ldots, \eta + p -1
    \text{.}
  \end{equation}
\end{proposition}
\begin{proof}
  This proof is from \cite[Chapter~2]{lidl+niederreiter:2}.

  Since $p$ is prime, $X^p-X-\alpha$ is either irreducible or
  split. In the second case, Eq.~\eqref{eq:63} is obvious.

  Suppose it is split and let $\eta$ be one of its roots. Then
  \begin{equation}
    \Tr_{\F_q/\F_p}(\alpha) = \Tr_{\F_q/\F_p}(\eta^p) - \Tr_{\F_q/\F_p}(\eta) = 0
    \text{,}
  \end{equation}
  where the last equality comes from
  \ref{th:basic-galois-theory:trace}.

  Suppose now that $\Tr_{\F_q/\F_p}(\alpha)=0$, and let $\eta$ be a
  root of $X^p-X-\alpha$ in its splitting field. Let $m=[\F_q:\F_p]$,
  then by \eqref{eq:78}
  \begin{equation}
    0=\Tr_{\F_q/\F_p}(\alpha) = \sum_{i=0}^{m-1}\alpha^{p^i} =
    \sum_{i=0}^{m-1}(\eta^p-\eta)^{p^i} =\eta^{q}-\eta
    \text{,}
  \end{equation}
  thus $\eta\in\F_q$.
\end{proof}

\pdfmargincomment{Linked to section 2.2.4.}
Following~\cite{vzgathen+shoup92,couveignes00}, we also use a
generalization of the trace, as already introduced in
Section~\ref{sec:comp-frob-trace}.

\begin{definition}[Pseudotrace]
  The $n$-th {\em pseudotrace} of order $m$ is the
  $\F_{p^m}$-linear operator
  \begin{equation*}
    \PTr_{(n,m)}: a \mapsto \sum_{\ell=0}^{n-1}a^{p^{m\ell}}
    \text{;}
  \end{equation*}
  for $m=1$, we call it the $n$-th pseudotrace and write $\PTr_n$.
\end{definition}

\begin{nota}
  \pdfmargincomment[color=red,subject=rev2]{Slightly more precise on
    where v lives.}  In our context, for $n=[\U_i:\U_j]=p^{i-j}$ and
  $m=[\U_j:\F_p]=p^jd$, $\PTr_{(n,m)}(v)$ coincides with
  $\Tr_{\U_{i}/\U_j}(v)$ for $v$ in $\U_i$; however $\PTr_{(n,m)}(v)$
  remains defined for $v$ in a field extension of $\U_i$, whereas
  $\Tr_{\U_{i}/\U_j}(v)$ is not.
\end{nota}


% Local Variables:
% mode:flyspell
% ispell-local-dictionary:"american"
% mode: TeX-PDF
% mode: reftex
% TeX-master: "../these"
% End:
%
% LocalWords:  Schreier Artin pseudotrace frobenius bivariate memoization
